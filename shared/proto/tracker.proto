syntax = "proto3";

package tracker;

service TrackerService {
    rpc RegisterNode(RegisterNodeRequest) returns (NodeResponse);
    rpc Heartbeat(HeartbeatRequest) returns (HeartbeatResponse);
    rpc GetAvailableNodes(Empty) returns (NodeList);
}

message RegisterNodeRequest {
  string node_id = 1;
  string ip_address = 2;
  int64 capacity = 3; // in MB
}

message RegisterNodeResponse {
  bool success = 1;
  string message = 2;
}

message HeartbeatRequest {
  string node_id = 1;
  int64 free_space = 2;
  int64 upload_speed = 3;
  int64 download_speed = 4;
}

message HeartbeatResponse {
  bool acknowledged = 1;
}

message NodeInfo {
  string node_id = 1;
  string ip_address = 2;
  int64 free_space = 3;
  int64 latency = 4;
}

message NodeList {
  repeated NodeInfo nodes = 1;
}

message Empty {}