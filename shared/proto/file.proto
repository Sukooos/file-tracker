syntax = "proto3";

package file;

service FileService {
  rpc UploadFile(UploadRequest) returns (UploadResponse);
  rpc DownloadFile(FileRequest) returns (stream FileChunk);
  rpc NotifyChunkReceived(ChunkAck) returns (AckResponse);
}

message UploadRequest {
  string filename = 1;
  bytes content = 2;
  string user_id = 3;
}

message UploadResponse {
  string file_id = 1;
  int32 chunk_count = 2;
}

message FileRequest {
  string file_id = 1;
}

message FileChunk {
  int32 chunk_index = 1;
  bytes data = 2;
}

message ChunkAck {
  string file_id = 1;
  string node_id = 2;
  int32 chunk_index = 3;
}

message AckResponse {
  bool success = 1;
}
